define("block_course_converter/activity_visual",["jquery","core/modal","core/modal_events"],(function($,Modal,ModalEvents){return{init:function(){$(".detach-block").on("click",(function(){$(".block-course-converter").clone(!0);$(".block-course-converter").addClass("d-none"),Modal.create({title:"Activity Tree Visual",body:this.displayActivityVisual(),large:!0}).then((function(modal){modal.show(),modal.getRoot().on(ModalEvents.hidden,(function(){$(".block-course-converter").removeClass("d-none"),updateSectionHighlight(null)}))}))}))},displayActivityVisual:function(){const container=$(".block_course_converter"),sections={};container.find(".activity-item[data-restrictions][data-index]").each((function(){const $item=$(this),sectionId=$item.closest(".section-page").data("section-number");sections[sectionId]||(sections[sectionId]=[]),sections[sectionId].push({element:$item,index:$item.data("index"),restrictions:$item.data("restrictions").split(",")})}));const grid=$('<div class="activity-grid row"></div>');return Object.keys(sections).sort().forEach((sectionId=>{const column=$('\n                    <div class="activity-column col-md-4 mb-4">\n                        <h5>Section '.concat(sectionId,'</h5>\n                        <div class="activity-list"></div>\n                    </div>\n                '));sections[sectionId].sort(((a,b)=>a.index-b.index)).forEach((activity=>{const iconClass=this.getActivityIcon(activity.element.data("activity-type"));column.find(".activity-list").append('\n                        <div class="activity-card mb-2 p-2"\n                             data-index="'.concat(activity.index,'"\n                             data-restrictions="').concat(activity.restrictions.join(","),'">\n                            <i class="fa ').concat(iconClass,' mr-2"></i>\n                            ').concat(activity.element.find(".activity-name").text(),"\n                        </div>\n                    "))})),grid.append(column)})),grid},getActivityIcon:function(type){const icons={quiz:"fa-question-circle",lesson:"fa-book-open",forum:"fa-comments",assign:"fa-file-upload",default:"fa-circle"};return icons[type]||icons.default},drawConnections:function(){$(".connection-line").remove();const svg=$('\n                <svg class="connection-layer" \n                     style="position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none;">\n                </svg>\n            ');$(".activity-grid").append(svg),$(".activity-card[data-restrictions]").each((function(){const source=$(this),sourcePos=source.offset();source.data("restrictions").split(",").forEach((restriction=>{const targetIndex=restriction.split("_").pop(),target=$('.activity-card[data-index="'.concat(targetIndex,'"]'));if(target.length){const targetPos=target.offset(),line=$('\n                            <line class="connection-line"\n                                x1="'.concat(sourcePos.left+source.width()-10,'" \n                                y1="').concat(sourcePos.top+source.height()/2,'"\n                                x2="').concat(targetPos.left+10,'"\n                                y2="').concat(targetPos.top+target.height()/2,'"\n                                stroke="#007bff"\n                                stroke-width="2"\n                                marker-end="url(#arrowhead)"/>\n                        '));svg.append(line)}}))})),svg.prepend('\n                <defs>\n                    <marker id="arrowhead" markerWidth="10" markerHeight="7" \n                            refX="9" refY="3.5" orient="auto">\n                        <polygon points="0 0, 10 3.5, 0 7" fill="#007bff"/>\n                    </marker>\n                </defs>\n            ')}}}));

//# sourceMappingURL=activity_visual.min.js.map